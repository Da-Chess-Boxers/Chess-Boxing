<br />
<h1>Let's play!</h1>

<%= link_to "New Game?", new_game_path %>

<div class = "container">
  <table class = "chessboard" cellpadding="0" cellspacing="0">
    <% 7.downto(0) do |row| %>
      <tr> 
        <% 0.upto(7) do |column| %>
          <td id = 'pos<%= "#{column}_#{row}"%>' class = 'droppable'>    
            <% @pieces.each do |piece|%>
              <% if piece.position_y.to_i == row && piece.position_x.to_i == column %>
                <%= link_to piece_path(piece) do %>
                  <%= image_tag(piece.show_image, class: "img-fluid draggable")  %>
                <% end %>
              <% end %>
            <% end %>
         </td >          
        <% end %>
      </tr>
    <% end %>
    <br class="clr">
  </table>
</div>

<script>

  $(function() {
    $(".draggable").draggable({
      containment: "table"
    });

    $(".droppable").droppable({
      drop: function( event, ui ){
        var squareId = event.target.id;
        $(squareId).append(ui.draggable);
        console.log("dropped!");
      }
    });
    /* $("td").droppable({
      drop: function( event, ui ) {
        $.ajax({
          type: 'PUT',
          url: 
          data: { piece: { position_y:, position_x: } }
        });
        alert( "dropped");
      }
    }); */

  });

</script>